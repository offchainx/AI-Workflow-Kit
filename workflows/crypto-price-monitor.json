{
  "name": "åŠ å¯†è´§å¸ä»·æ ¼ç›‘æ§ä¸äº¤æ˜“ä¿¡å·",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 1
            }
          ]
        }
      },
      "name": "æ¯åˆ†é’Ÿè§¦å‘",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1,
      "position": [250, 300]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT",
        "options": {}
      },
      "name": "è·å–BTCä»·æ ¼",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [450, 300]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1h&limit=20",
        "options": {}
      },
      "name": "è·å–å†å²Kçº¿",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [450, 450]
    },
    {
      "parameters": {
        "jsCode": "// è®¡ç®—æŠ€æœ¯æŒ‡æ ‡\nconst currentPrice = parseFloat($node[\"è·å–BTCä»·æ ¼\"].json.price);\nconst klines = $node[\"è·å–å†å²Kçº¿\"].json;\n\n// æå–æ”¶ç›˜ä»·\nconst closePrices = klines.map(k => parseFloat(k[4]));\n\n// è®¡ç®—SMA (ç®€å•ç§»åŠ¨å¹³å‡)\nconst sma = closePrices.reduce((sum, price) => sum + price, 0) / closePrices.length;\n\n// è®¡ç®—RSI (ç›¸å¯¹å¼ºå¼±æŒ‡æ ‡)\nfunction calculateRSI(prices, period = 14) {\n  let gains = 0;\n  let losses = 0;\n  \n  for (let i = 1; i < prices.length; i++) {\n    const change = prices[i] - prices[i-1];\n    if (change > 0) {\n      gains += change;\n    } else {\n      losses -= change;\n    }\n  }\n  \n  const avgGain = gains / period;\n  const avgLoss = losses / period;\n  const rs = avgGain / avgLoss;\n  const rsi = 100 - (100 / (1 + rs));\n  \n  return rsi;\n}\n\nconst rsi = calculateRSI(closePrices);\n\n// è®¡ç®—MACD\nfunction calculateEMA(prices, period) {\n  const k = 2 / (period + 1);\n  let ema = prices[0];\n  \n  for (let i = 1; i < prices.length; i++) {\n    ema = prices[i] * k + ema * (1 - k);\n  }\n  \n  return ema;\n}\n\nconst ema12 = calculateEMA(closePrices, 12);\nconst ema26 = calculateEMA(closePrices, 26);\nconst macd = ema12 - ema26;\n\n// ç”Ÿæˆäº¤æ˜“ä¿¡å·\nlet signal = 'HOLD';\nlet reason = '';\n\nif (rsi < 30 && currentPrice < sma * 0.98) {\n  signal = 'BUY';\n  reason = 'RSIè¶…å– + ä»·æ ¼ä½äºSMA 2%';\n} else if (rsi > 70 && currentPrice > sma * 1.02) {\n  signal = 'SELL';\n  reason = 'RSIè¶…ä¹° + ä»·æ ¼é«˜äºSMA 2%';\n} else if (macd > 0 && rsi > 50 && rsi < 70) {\n  signal = 'BUY';\n  reason = 'MACDé‡‘å‰ + RSIä¸­æ€§åå¼º';\n} else if (macd < 0 && rsi < 50 && rsi > 30) {\n  signal = 'SELL';\n  reason = 'MACDæ­»å‰ + RSIä¸­æ€§åå¼±';\n}\n\nreturn {\n  json: {\n    symbol: 'BTCUSDT',\n    currentPrice: currentPrice,\n    sma: sma,\n    rsi: rsi.toFixed(2),\n    macd: macd.toFixed(2),\n    signal: signal,\n    reason: reason,\n    timestamp: new Date().toISOString(),\n    priceChange24h: ((currentPrice - closePrices[0]) / closePrices[0] * 100).toFixed(2)\n  }\n};"
      },
      "name": "è®¡ç®—æŠ€æœ¯æŒ‡æ ‡",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [650, 375]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.signal }}",
              "operation": "notEqual",
              "value2": "HOLD"
            }
          ]
        }
      },
      "name": "æ˜¯å¦æœ‰äº¤æ˜“ä¿¡å·",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [850, 375]
    },
    {
      "parameters": {
        "chatId": "YOUR_CHAT_ID",
        "text": "=ğŸš¨ äº¤æ˜“ä¿¡å·è­¦æŠ¥\n\nå¸ç§: {{ $json.symbol }}\nä¿¡å·: {{ $json.signal }}\nåŸå› : {{ $json.reason }}\n\nå½“å‰ä»·æ ¼: ${{ $json.currentPrice }}\n24hå˜åŒ–: {{ $json.priceChange24h }}%\nRSI: {{ $json.rsi }}\nMACD: {{ $json.macd }}\nSMA(20): ${{ $json.sma.toFixed(2) }}\n\næ—¶é—´: {{ $json.timestamp }}",
        "additionalFields": {}
      },
      "name": "å‘é€Telegramè­¦æŠ¥",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [1050, 300],
      "credentials": {
        "telegramApi": {
          "id": "4",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "operation": "insert",
        "table": "trading_signals",
        "columns": "symbol,price,signal,reason,rsi,macd,sma,created_at",
        "additionalFields": {}
      },
      "name": "è®°å½•åˆ°æ•°æ®åº“",
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [1050, 450],
      "credentials": {
        "supabaseApi": {
          "id": "3",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {},
      "name": "æ— ä¿¡å·ï¼Œè·³è¿‡",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [1050, 550]
    }
  ],
  "connections": {
    "æ¯åˆ†é’Ÿè§¦å‘": {
      "main": [
        [
          {
            "node": "è·å–BTCä»·æ ¼",
            "type": "main",
            "index": 0
          },
          {
            "node": "è·å–å†å²Kçº¿",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–BTCä»·æ ¼": {
      "main": [
        [
          {
            "node": "è®¡ç®—æŠ€æœ¯æŒ‡æ ‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–å†å²Kçº¿": {
      "main": [
        [
          {
            "node": "è®¡ç®—æŠ€æœ¯æŒ‡æ ‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¡ç®—æŠ€æœ¯æŒ‡æ ‡": {
      "main": [
        [
          {
            "node": "æ˜¯å¦æœ‰äº¤æ˜“ä¿¡å·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ˜¯å¦æœ‰äº¤æ˜“ä¿¡å·": {
      "main": [
        [
          {
            "node": "å‘é€Telegramè­¦æŠ¥",
            "type": "main",
            "index": 0
          },
          {
            "node": "è®°å½•åˆ°æ•°æ®åº“",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æ— ä¿¡å·ï¼Œè·³è¿‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "id": "2",
      "name": "é‡åŒ–äº¤æ˜“"
    }
  ],
  "triggerCount": 0,
  "updatedAt": "2025-10-24T00:00:00.000Z",
  "versionId": "1"
}
